# Saturnin-Short AEAD Implementation

## Overview

This repository contains a reference implementation of **Saturnin-Short**, a lightweight block cipher and AEAD (Authenticated Encryption with Associated Data) algorithm. This implementation includes:

* `saturnin.c` – core block cipher operations (S-boxes, MDS, SR permutations).
* `custom_encrypt.c` – AEAD wrapper with test variables for plaintext, nonce, and key.
* Optional `encrypt.c` – reference AEAD wrapper for standard API.
* Makefile to build and run the tests easily.

This implementation is for **educational and testing purposes** and is **not optimized for production**.

---

## Prerequisites

* **Compiler:** GCC (version >= 9 recommended)
* **Operating System:** Linux or Unix-like environment
* **Dependencies:** Standard C library only; no external dependencies.

---

## Compilation Instructions

1. Open a terminal and navigate to the directory containing the source files (`saturnin.c`, `custom_encrypt.c`).
2. Build the executable using the provided Makefile:

```bash
make
```

This will produce an executable named `saturnin_test`.

3. To clean compiled files:

```bash
make clean
```

---

## Running the Code

1. After compilation, run the executable:

```bash
./saturnin_test
```

2. The program will:

* Use test variables for plaintext, nonce, and key defined in `custom_encrypt.c`.
* Encrypt the plaintext using Saturnin-Short.
* Print the ciphertext.
* Decrypt the ciphertext and print the recovered plaintext.
* Validate correctness by comparing decrypted output with the original plaintext.

> **Note:** To test with different plaintexts, nonces, or keys, edit the variables in `custom_encrypt.c`:

```c
unsigned char key[32]   = { ... }; // 256-bit key
unsigned char nonce[16] = { ... }; // 128-bit nonce
unsigned char pt[16]    = { ... }; // plaintext (<= 15 bytes)
```

---

## Test Vectors

* Test vectors are based on the **Saturnin-Short specification** from NIST LWC candidates.
* Ciphertext is 32 bytes per block, padded with `0x80` followed by zeros as necessary.
* Nonce and key lengths must be 16 bytes and 32 bytes respectively.

For reference, the original specification documents and test vectors are included in the file below. These text vectors were generated by using the /tests/genkar_aead_short.c repo in the official Saturnin submission [Link](https://lab.las3.de/gitlab/lwc/candidates/tree/b974ca1d16e4eff0afc1ce298de4b5f9339a4ab5/saturnin/Implementations/tests).

```
Implementations/crypto_aead/saturninshortv2/LWC_AEAD_KAT_256_128.txt
```
---

## Code Structure

| File               | Purpose                                                                    |
| ------------------ | -------------------------------------------------------------------------- |
| `saturnin.c`       | Core block cipher: S-box, MDS, SR\_slice, and encryption/decryption rounds |
| `custom_encrypt.c` | AEAD wrapper using test variables; can be edited for experiments           |
| `encrypt.c`        | Reference AEAD API for Saturnin-Short                                      |
| `Makefile`         | Build automation script                                                    |

---

## Notes

* Saturnin-Short **does not support additional data** (AD). Passing non-zero AD will return an error.
* Maximum plaintext length is **15 bytes**; longer inputs will return an error.
* Ciphertext is always **32 bytes**.

---

## References

* Saturnin-Short: [LWC Candidate Submission](https://csrc.nist.gov/projects/lightweight-cryptography)
* Saturnin NIST Submission: [Link](https://lab.las3.de/gitlab/lwc/candidates/tree/b974ca1d16e4eff0afc1ce298de4b5f9339a4ab5/saturnin/Implementations/tests)
* NIST Lightweight Cryptography: [Test Vectors](https://csrc.nist.gov/projects/lightweight-cryptography/round-2-submissions)
